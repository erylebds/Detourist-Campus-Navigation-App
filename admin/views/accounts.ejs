<h1 class="section-title">accounts</h1>

<!-- show messages -->
<% if (accError) { %>
    <div class="msg-error"><%= accError %></div>
<% } %>
<% if (accMsg) { %>
    <div class="msg-success"><%= accMsg %></div>
<% } %>

<!-- my account section -->
<div class="card-box">
    <h2>my account</h2>
    <p><strong>username:</strong> <span id="currentUsername"><%= currentAdmin.username %></span></p>
    <p><strong>email:</strong> <%= currentAdmin.email %></p>
    <div class="account-buttons">
        <button class="btn-primary" data-modal="changeUsernameModal">change username</button>
        <button class="btn-primary" data-modal="changeEmailModal">change email</button>
        <button class="btn-primary" data-modal="changePasswordModal">change password</button>
    </div>
</div>

<!-- other admin accounts section -->
<div class="card-box">
    <h2>other admin accounts</h2>
    <button class="btn-primary mb-2" id="addAdminBtn">+ add new admin</button>
    <table class="admin-table">
        <thead>
            <tr>
                <th>id</th>
                <th>username</th>
                <th>email</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
            <% otherAdmins.forEach(admin => { %>
            <tr data-id="<%= admin.admin_id %>">
                <td><%= admin.admin_id %></td>
                <td><%= admin.username %></td>
                <td><%= admin.email %></td>
                <td>
                    <!-- edit and delete actions -->
                    <a href="#" class="edit-admin-link" data-id="<%= admin.admin_id %>">edit</a> |
                    <a href="#" class="delete-admin-link" data-id="<%= admin.admin_id %>" style="color:#e74c3c;">delete</a>
                </td>
            </tr>
            <% }) %>
        </tbody>
    </table>
</div>

<!-- modals container -->
<div id="modals-container">

    <!-- change username modal -->
    <div class="modal" id="changeUsernameModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>change username</h3>
            <form id="myUsernameForm">
                <label>new username:</label>
                <input type="text" name="new_username" required>
                <label>current password:</label>
                <input type="password" name="cu_password" required placeholder="enter current password">
                <button type="submit" class="btn-primary">save</button>
            </form>
        </div>
    </div>

    <!-- change email modal -->
    <div class="modal" id="changeEmailModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>change email</h3>
            <form id="myEmailForm">
                <label>new email:</label>
                <input type="email" name="new_email" required>
                <button type="submit" class="btn-primary">save</button>
            </form>
        </div>
    </div>

    <!-- change password modal -->
    <div class="modal" id="changePasswordModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>change password</h3>
            <form id="myPasswordForm">
                <label>old password:</label>
                <input type="password" name="old_password" required>
                <label>new password:</label>
                <input type="password" name="new_password" required>
                <label>confirm new password:</label>
                <input type="password" name="new_password2" required>
                <button type="submit" class="btn-primary">save</button>
            </form>
        </div>
    </div>

    <!-- edit other admin modal -->
    <div class="modal" id="editAdminModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>edit admin account</h3>
            <form id="editAdminForm">
                <input type="hidden" name="admin_id">
                <label>username:</label>
                <input type="text" name="username" required>
                <label>email:</label>
                <input type="email" name="email" required>
                <label>password:</label>
                <input type="password" name="password" placeholder="leave blank to keep current">
                <button type="submit" class="btn-primary">save</button>
            </form>
        </div>
    </div>

    <!-- add new admin modal -->
    <div class="modal" id="addAdminModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>add new admin</h3>
            <form id="addAdminForm">
                <label>username:</label>
                <input type="text" name="username" required>
                <label>email:</label>
                <input type="email" name="email" required>
                <label>password:</label>
                <input type="password" name="password" required>
                <button type="submit" class="btn-primary">create</button>
            </form>
        </div>
    </div>

</div>

<!-- load scripts -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/js/account.js"></script>
